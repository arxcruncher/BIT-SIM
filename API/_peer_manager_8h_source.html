<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PeerManager.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>PeerManager.h</h1><a href="_peer_manager_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef _PeerManager_H_</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define _PeerManager_H_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="comment">/*</span>
<a name="l00005"></a>00005 <span class="comment"> * Defines a peer managment class.</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> * This file is part of a BitTorrent Simulator</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * Copyright (c) 2009. Blekinge Institute of Technology (BTH).</span>
<a name="l00010"></a>00010 <span class="comment"> * All Rights Reserved.</span>
<a name="l00011"></a>00011 <span class="comment"> *</span>
<a name="l00012"></a>00012 <span class="comment"> * Contact information for redistribution (binary or source code):</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * Karel De Vogeleer</span>
<a name="l00015"></a>00015 <span class="comment"> * Department of Telecommunications System</span>
<a name="l00016"></a>00016 <span class="comment"> * School of Engineering</span>
<a name="l00017"></a>00017 <span class="comment"> * SE-371 79 Karlskrona</span>
<a name="l00018"></a>00018 <span class="comment"> * SWEDEN</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * kdv@bth.se</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> */</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;omnetpp.h&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="_peer_manager_8h.html#ad6664b6aa0b2ec18771fe01aefa1e760">00030</a> <span class="preprocessor">#define CLOSED 0</span>
<a name="l00031"></a><a class="code" href="_peer_manager_8h.html#a9960d0d5ae92fc92c70bbb84c2a5c0cc">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define PENDING 1</span>
<a name="l00032"></a><a class="code" href="_peer_manager_8h.html#a1354b70ac6803a06beebe84f61b5f95b">00032</a> <span class="preprocessor"></span><span class="preprocessor">#define OPEN 2</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a>00034 <span class="keyword">using namespace </span>std;
<a name="l00035"></a>00035 
<a name="l00039"></a><a class="code" href="struct_peer.html">00039</a> <span class="keyword">struct </span><a class="code" href="struct_peer.html" title="Unifies information of other clients in the swarm.">Peer</a>{
<a name="l00043"></a><a class="code" href="struct_peer.html#abf7501af9cf907d1c5969413be91194b">00043</a>         <span class="keywordtype">string</span> <a class="code" href="struct_peer.html#abf7501af9cf907d1c5969413be91194b" title="Peer ID of the client, owning the other fields in this struct.">peer_id</a>;
<a name="l00047"></a><a class="code" href="struct_peer.html#a2a6087f0d018a26fd69e0d8abc0e3dc3">00047</a>         simtime_t <a class="code" href="struct_peer.html#a2a6087f0d018a26fd69e0d8abc0e3dc3" title="The time when the choked value was last changed.">time</a>;
<a name="l00051"></a><a class="code" href="struct_peer.html#a7a8704ceb2df18eae59e2f63a0e3d93e">00051</a>         <span class="keywordtype">bool</span> <a class="code" href="struct_peer.html#a7a8704ceb2df18eae59e2f63a0e3d93e" title="Defines whether peer_id is interested in the PeerManager class.">interested</a>;
<a name="l00055"></a><a class="code" href="struct_peer.html#abd658839666ca26284a10978bc4dec85">00055</a>         <span class="keywordtype">bool</span> <a class="code" href="struct_peer.html#abd658839666ca26284a10978bc4dec85" title="Defines whether peer_id is choked by the peer owning the PeerManager class.">choked</a>;
<a name="l00059"></a><a class="code" href="struct_peer.html#a054ce4c999fa3b8a0caea9aada6e6928">00059</a>         <span class="keywordtype">bool</span> <a class="code" href="struct_peer.html#a054ce4c999fa3b8a0caea9aada6e6928" title="Defines wheter the peer_id is a seeder or not.">seeder</a>;
<a name="l00065"></a><a class="code" href="struct_peer.html#a338729e000afebd3ae5f71acf4dca1be">00065</a>         <span class="keywordtype">int</span> <a class="code" href="struct_peer.html#a338729e000afebd3ae5f71acf4dca1be" title="Defines the status of the connection.">status</a>;
<a name="l00069"></a><a class="code" href="struct_peer.html#ae258c4e0529170f33151b21a98422e7e">00069</a>         simtime_t <a class="code" href="struct_peer.html#ae258c4e0529170f33151b21a98422e7e" title="Tells when the connection status was last changed.">statusChange</a>;
<a name="l00073"></a><a class="code" href="struct_peer.html#a1c961a81a16c3080f8eea453c08dc053">00073</a>         <span class="keywordtype">int</span> <a class="code" href="struct_peer.html#a1c961a81a16c3080f8eea453c08dc053" title="Defines the amount of bytes that were downloaded since the last time reference.">downloaded</a>;
<a name="l00077"></a><a class="code" href="struct_peer.html#aba538e1c0f387ec05d1b024a18e0d21a">00077</a>         <span class="keywordtype">int</span> <a class="code" href="struct_peer.html#aba538e1c0f387ec05d1b024a18e0d21a" title="Defines the gate at which peer_id is connected to.">gate</a>;
<a name="l00078"></a>00078 };
<a name="l00079"></a>00079 
<a name="l00086"></a><a class="code" href="class_peer_manager.html">00086</a> <span class="keyword">class </span><a class="code" href="class_peer_manager.html" title="The PeerManager class manages client infornation for a BT client.">PeerManager</a>{
<a name="l00087"></a>00087         <span class="keyword">private</span> :
<a name="l00091"></a><a class="code" href="class_peer_manager.html#aa7d55f5139d4e4f04f6fa1c3532c6ea6">00091</a>                 <span class="keywordtype">string</span> <a class="code" href="class_peer_manager.html#aa7d55f5139d4e4f04f6fa1c3532c6ea6" title="Defines the Peer ID of the peer that owns this class.">peer_id</a>;
<a name="l00095"></a><a class="code" href="class_peer_manager.html#a312262af496233c50b0cced49cc14523">00095</a>                 vector&lt;Peer&gt; <a class="code" href="class_peer_manager.html#a312262af496233c50b0cced49cc14523" title="Array of peer information of which peer_id has notice of.">peers</a>;
<a name="l00099"></a>00099                 vector&lt;Peer&gt;::iterator <a class="code" href="class_peer_manager.html#a4ffc40ac113204bdb5ad8bcd931088b4" title="Looks up the pointer to a Peer struct containing information of peer.">peerLookUp</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer);
<a name="l00100"></a>00100         
<a name="l00101"></a>00101         <span class="keyword">public</span> :
<a name="l00105"></a>00105                 <span class="keywordtype">int</span>  <a class="code" href="class_peer_manager.html#a514797d8ab047ddfa2478455c4c67fb8" title="Returns whether peer_id is choked by this client.">getStatus</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer);
<a name="l00109"></a>00109                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#a210ad17472af754939a1a09d143b8e63" title="Sets the conenction to peer to established.">conOpenend</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer, simtime_t time);
<a name="l00113"></a>00113                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#ad4f97fb4b9090f49bf17c96cb01e5659" title="Sets the conenction to peer to pending.">conPending</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer, simtime_t time);
<a name="l00114"></a>00114                 
<a name="l00118"></a>00118                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#a34a1b16381e380e496b3f094af2efb20" title="Adds an empty entry for peer in the database.">addPeer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer);
<a name="l00124"></a>00124                 <span class="keywordtype">int</span>  <a class="code" href="class_peer_manager.html#a380721e3ee0dc82463c9ff22b36a675b" title="Returns if peer has an entry in the database.">registredPeer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer);
<a name="l00130"></a>00130                 <span class="keywordtype">int</span>  <a class="code" href="class_peer_manager.html#a0002e84ed00db8fa8b62255bbeffb449" title="Returns whether peer is choked by this client.">getPeerChoked</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer);
<a name="l00134"></a>00134                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#a44e28d700d45d5b690c292122120adce" title="Sets the status of peer to seeder in the database.">setPeerAsSeeder</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer);
<a name="l00141"></a>00141                 <span class="keywordtype">int</span>  <a class="code" href="class_peer_manager.html#a4bbb832353c156b6c22b0d7d3ab18623" title="Returns the seeder/leecher status of peer.">isPeerASeeder</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer);
<a name="l00145"></a>00145                 <span class="keywordtype">int</span>  <a class="code" href="class_peer_manager.html#ac8fea8da1ed4224ab25435915f86070c" title="Returns the amount of established conenctions.">getAmountOfConnections</a>();
<a name="l00149"></a>00149                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#ab1b08ddf68a10ed2269bed6bfa05d35c" title="Pushes back all peers that are not connected in the peer vector.">getNewPeers</a>(vector&lt;string&gt; *peer);
<a name="l00153"></a>00153                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#acfbf2c98110ea0e2ca639922693cb675" title="Pushes back all peers that can be found in the database in the peerList vector.">getPeerList</a>(vector&lt;string&gt; *peerList);
<a name="l00157"></a>00157                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#ad83196a1844ccd95ab92a07c9cd35c88" title="Deletes the entry in the database correspending to peer.">deletePeer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer);
<a name="l00161"></a>00161                 <span class="keywordtype">int</span> <a class="code" href="class_peer_manager.html#a47c4f8402b31f72d3f6873e0d2122112" title="Sets all the PENDING connections to CLOSED that are pending for more then 1 minute...">resetPendingPeers</a>(simtime_t time);
<a name="l00165"></a>00165                 <span class="keywordtype">int</span> <a class="code" href="class_peer_manager.html#a993ae610605f1a1835498897d4cc2dd1" title="Returns the gate to which peer is conencted to.">getGate</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer);
<a name="l00169"></a>00169                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#a0650b3fd458c7bfee2005121cd1e340e" title="Sets the gate to which peer is conencted to.">setGate</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer, <span class="keywordtype">int</span> gate);
<a name="l00170"></a>00170 
<a name="l00174"></a>00174                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#af6b765c610c41924c58d997eece0db41" title="Sets the download tracks off every peer entry to 0.">resetDownload</a>();
<a name="l00178"></a>00178                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#a006c2b1e341967c196517ff2c0ac031d" title="Adds the download to the peers information space.">registerDownload</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer, <span class="keywordtype">int</span> byte);
<a name="l00182"></a>00182                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#a2bb4630fb69dd6b56e59958a150e9f1c" title="Pushes back the three fastest downloaders in the peerList vector.">getFastestDownloader</a>(vector&lt;string&gt; *peerList);
<a name="l00186"></a>00186                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#afa9785e81275fc45a30c41b5aec489a7" title="Pushes back the three most recently unchoked peers in the peerList vector.">getRecentlyUnchoked</a>(vector&lt;string&gt; *peerList);
<a name="l00190"></a>00190                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#a0849558525139fff4f94a4be0ed540bf" title="Sets the choke state of peer and records the timestamp.">setChokePeer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *peer, <span class="keywordtype">bool</span> choke, simtime_t time);
<a name="l00194"></a>00194                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#ad612062d03cfc6f190b198e2d5c68a3a" title="Pushes back all the peers in the choked vector that are choked and not in the unChoked...">isPeerChoked</a>(vector&lt;string&gt; *unChoked, vector&lt;string&gt; *choked);
<a name="l00198"></a>00198                 <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="class_peer_manager.html#aae1840077db1a892e637af1b699ce063" title="Returns a random interested and choked peer.">getRandomInterested</a>();
<a name="l00202"></a>00202                 <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="class_peer_manager.html#aedf5baf5edca76adecb78eee335d4f4b" title="Returns a random choked and interested peer.">getRandomChoked</a>();
<a name="l00207"></a>00207                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#abccd7d80ce86d9250e6b8abfbce0d06e" title="Sets the interested parameter of peer.">setPeerInterested</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* peer, <span class="keywordtype">bool</span> interest);
<a name="l00213"></a>00213                 <span class="keywordtype">int</span>  <a class="code" href="class_peer_manager.html#a90aae7dc27dc9ff52c0f67e0b8278c4b" title="Returns if there are interested peers or not.">getIntrests</a>();
<a name="l00219"></a>00219                 <span class="keywordtype">int</span>  <a class="code" href="class_peer_manager.html#ab7df7d6773ec9436d6fd1b064f2b6359" title="Returns if there are choked peers or not.">getChoked</a>();
<a name="l00220"></a>00220 
<a name="l00226"></a>00226                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#abbeddaf377a2b75379ff690426c828ee" title="Registers the ID of the peer that owns this class.">setPeerID</a>(<span class="keywordtype">string</span> name);
<a name="l00227"></a>00227 
<a name="l00231"></a>00231                 <span class="keywordtype">void</span> <a class="code" href="class_peer_manager.html#abd9273d32348b2cd47d44742e5092461" title="Writes the content of the peer database to cout.">writePeers</a>();
<a name="l00235"></a>00235                 <a class="code" href="class_peer_manager.html#ab158511ed8b34678e348a7157b145d8e" title="Destroys this PeerManager.">~PeerManager</a>();
<a name="l00236"></a>00236 };
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
